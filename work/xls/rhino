//!/bin/js

load( '.../lib/mimis/js' )

var HSSFWorkbook = org.apache.poi.hssf.usermodel.HSSFWorkbook
var POIFSFileSystem = org.apache.poi.poifs.filesystem.POIFSFileSystem
var FileInputStream = java.io.FileInputStream

try {
    var workbook = (
//        new HSSFWorkbook(
            new POIFSFileSystem( 
                //this.getClass().getResourceAsStream(
                new FileInputStream(
                    'test.xlsx'
                )
            )
//        )
    )

    var sheet = workbook.getSheetAt( 0 )

    var rows = sheet.rowIterator()
    while( rows.hasNext() ) {           
        var row = rows.next()
        console.log( "Row #" + row.getRowNum() )
 
        var cells = row.cellIterator()
        while( cells.hasNext() ) {
            var cell = cells.next()
            console.log( "Cell #" + cell.getCellNum() )
            switch ( cell.getCellType() ) {
            case HSSFCell.CELL_TYPE_NUMERIC:
                console.log( cell.getNumericCellValue() )
                break
            case HSSFCell.CELL_TYPE_STRING: 
                console.log( cell.getStringCellValue() )
                break
            default:
                console.log( 'Unsuported Cell Type' )
                break
            }
        }
    }
} catch ( ioe ) {
    console.log( ioe )
}
